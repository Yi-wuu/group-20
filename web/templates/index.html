<html>
<head>

    <div style = "text-align: center;">dublin bike</div>
    <!-- <link rel=stylesheet type="text/css" href="index.css"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script

src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAvBNXUTSTxrubQdbSTLWk01GbuAEoq2H0&sensor=false">
</script>

<script>

    var myCenter=new google.maps.LatLng(53.350140, -6.266155);

function initialize() {
    var mapProp = {
        center: new google.maps.LatLng(53.350140, -6.266155),
        zoom: 13,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

    var marker = new google.maps.Marker({
        position: myCenter,
    });
    // $.getJSON("http://127.0.0.1:5000/stations", null, function (data) {
    //     showStationMarkers(data);
    // });

    // $.getJSON("http://127.0.0.1:5000/bikeMix", null, function (obj) {
    //     showStationMarkers(obj);
    // });



//     function showStationMarkers(data) {
//         let json = $.getJSON("http://127.0.0.1:5000/stations", null, function (data) {

//             // if ('dynamicBike' in data) {

//                 var stations = data.stations;

                

//                 for (var i = 0; i < stations.length; i++) {
//                     var lat = stations[i].lat;
//                     var lng = stations[i].lng;
//                     var infowindow = new google.maps.InfoWindow();

//                     // stations[i].number + " " +stations[i].name + " "+ stations[i].bike_stands;
//                     var stationsInfo =  '<div class="info_content">' +
//                     '<p>' + 'station_number:' + stations[i].number + '</p>' +
//                     '<p>' + 'station_name:'+ stations[i].name + '</p>' + '<p>' + 'station_bike_stands:'+ stations[i].bike_stands + '</p>' +
//                         '</div>';
//                     // console.log(stationsInfo);
//                     var station_number = stations[i].number;
//                     var marker = new google.maps.Marker({
//                         position: {
//                             lat: lat,
//                             lng: lng
//                         },
//                         map: map,
//                         animation:google.maps.Animation.Drop,
//                         title: stations[i].name,
//                         station_number: stations[i].number

//                     });
//                     marker.setMap(map);

//                     google.maps.event.addListener(marker, 'click', (function (marker, i) {
//                     var contentString = stationsInfo;
//                     // console.log(stationsInfo);
//                     var infowindow = new google.maps.InfoWindow({
//                     content: contentString
//                     })

//                     return function () {
//                     infowindow.open(map, marker);
//                     }
//                     })(marker, i));


//                 };

//             // }

//         });


//     }


// }



// function showStationMarkers(obj) {
//         let json = $.getJSON("http://127.0.0.1:5000/bikeMix", null, function (obj) {

//             // if ('stations' in data) {

//                 var dynamicBike = obj.bikeMix;

//                 console.log('stations', dynamicBike);
//                 for (var i = 0; i < dynamicBike.length; i++) {
//                     var lat = dynamicBike[i].lat;
//                     var lng = dynamicBike[i].lng;
//         var infowindow = new google.maps.InfoWindow();

//                     // stations[i].number + " " +stations[i].name + " "+ stations[i].bike_stands;
//                     var stationsInfo =  '<div class="info_content">' +
//         '<p>' + 'station_number:' + dynamicBike[i].number + '</p>' +
//         '<p>' + 'station_name:'+ dynamicBike[i].name + '</p>' + '<p>' + 'station_bike_stands:'+ dynamicBike[i].bike_stands + '</p>' +
//                         '</div>';
//                     // console.log(stationsInfo);
//                     var station_number = dynamicBike[i].number;
//                     var marker = new google.maps.Marker({
//                         position: {
//                             lat: lat,
//                             lng: lng
//                         },
//                         map: map,
//                         animation:google.maps.Animation.Drop,
//                         title: dynamicBike[i].name,
//                         station_number: dynamicBike[i].number

//                     });
//                     marker.setMap(map);

//                     google.maps.event.addListener(marker, 'click', (function (marker, i) {
//                     var contentString = stationsInfo;
//                     // console.log(stationsInfo);
//                     var infowindow = new google.maps.InfoWindow({
//                     content: contentString
//                     })

//                     return function () {
//                     infowindow.open(map, marker);
//                     }
//                     })(marker, i));


//                 };

//             // }

//         });


//     }


// }
// http://127.0.0.1:5000/bikeMix"
    function showStationMarkers() {
        let json = $.getJSON("http://127.0.0.1:5000/bikeMix", null, function (obj) {

            // if ('stations' in data) {

                var stations = obj.bikeMix;

                console.log('stations', stations);
                for (var i = 0; i < stations.length; i++) {
                    var lat = stations[i].lat;
                    var lng = stations[i].lng;
        var infowindow = new google.maps.InfoWindow();

                    // stations[i].number + " " +stations[i].name + " "+ stations[i].bike_stands;
                    var stationsInfo =  '<div class="info_content">' +
        '<p>' + 'station_number:' + stations[i].number + '</p>' +
        '<p>' + 'station_name:'+ stations[i].name + '</p>' + '<p>' + 'station_bike_stands:'+ stations[i].bike_stands + '</p>' +
        'available_bike_stands:'+ stations[i].available_bike_stands + '</p>' +    
        'available_bikes:'+ stations[i].available_bikes + '</p>' +               
                        '</div>';
                    // console.log(stationsInfo);
                    var station_number = stations[i].number;
                    var marker = new google.maps.Marker({
                        position: {
                            lat: lat,
                            lng: lng
                        },
                        map: map,
                        animation:google.maps.Animation.Drop,
                        title: stations[i].name,
                        station_number: stations[i].number

                    });
                    marker.setMap(map);






                    google.maps.event.addListener(marker, 'click', (function (marker, i) {

                    var contentString = stationsInfo;
                    // var number_id = station_number;
                    // showchart(number_id);
                    // console.log(stationsInfo);
                    var infowindow = new google.maps.InfoWindow({
                    content: contentString
                    })

                    return function () {
                    infowindow.open(map, marker);
                    }
                    })(marker, i));


                };
                

            // }

        });


    }

    showStationMarkers();
}

google.maps.event.addDomListener(window, 'load', initialize);
function show_weather(){
 let json = $.getJSON("http://127.0.0.1:5000/weather", null, function (data) {

    if ('weather' in data) {

        var weather = data.weather;

        console.log('weather', weather);
        var description = weather[0].description;
        var feels_like = weather[0].feels_like;
        var gust = weather[0].gust;
        display_info = "<table border = 1 id=\"weatherTable\">";

            display_info += "<tr><td>temperature</td><td>" + weather[0].temp + "</td></tr>";
            display_info += "<tr><td>min temperature</td><td>" + weather[0].temp_min + "</td></tr>";
            display_info += "<tr><td>max temperature</td><td>" + weather[0].temp_max + "</td></tr>";
            display_info += "<tr><td>feels like</td><td>" + weather[0].feels_like + "</td></tr>";
            display_info += "<tr><td>description</td><td>" + weather[0].description + "</td></tr>";
            display_info += "<tr><td>pressure</td><td>" + weather[0].pressure + " hpa</td></tr>";
            display_info += "<tr><td>humidity</td><td>" + weather[0].humidity + "%</td></tr>";
            display_info += "<tr><td>sunrise</td><td>" + weather[0].sunrise + "</td></tr>";
            display_info += "<tr><td>sunset</td><td>" + weather[0].sunset + "</td></tr>";





            display_info += "</table>"

            document.getElementById("weather").innerHTML = display_info;
    }

});
}
show_weather();
</script>

</head>

<body>
<h1>Dublin Bike</h1>
<div id="googleMap" style="width:100%;height:500px; "></div>
<hr>
<h3>Weather</h3>
<div id="weather" style="width:100%;height:500px; "></div>

       <div id="chart_div" style="width: 100%; height: 500px;"></div>
</body>
</html>